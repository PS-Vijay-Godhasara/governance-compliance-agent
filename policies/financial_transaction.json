{
  "policy_id": "financial_transaction",
  "name": "Financial Transaction Validation Policy",
  "version": "1.5",
  "description": "Validation rules for financial transactions and payments",
  "rules": [
    {
      "field": "transaction_id",
      "type": "string",
      "required": true,
      "pattern": "^TXN[0-9]{10}$",
      "description": "Unique transaction identifier"
    },
    {
      "field": "amount",
      "type": "number",
      "required": true,
      "min": 0.01,
      "max": 1000000,
      "precision": 2,
      "description": "Transaction amount with 2 decimal places"
    },
    {
      "field": "currency",
      "type": "string",
      "required": true,
      "enum": ["USD", "EUR", "GBP", "CAD", "AUD"],
      "description": "Supported currency codes"
    },
    {
      "field": "payment_method",
      "type": "object",
      "required": true,
      "properties": {
        "type": {"type": "string", "required": true, "enum": ["credit_card", "debit_card", "bank_transfer", "digital_wallet"]},
        "last_four": {"type": "string", "pattern": "^[0-9]{4}$"},
        "expiry_month": {"type": "integer", "min": 1, "max": 12},
        "expiry_year": {"type": "integer", "min": 2024, "max": 2035}
      },
      "description": "Payment method details"
    },
    {
      "field": "merchant_info",
      "type": "object",
      "required": true,
      "properties": {
        "merchant_id": {"type": "string", "required": true, "min_length": 5},
        "category": {"type": "string", "required": true, "enum": ["retail", "online", "restaurant", "gas_station", "atm"]},
        "country": {"type": "string", "required": true, "pattern": "^[A-Z]{2}$"}
      },
      "description": "Merchant information"
    },
    {
      "field": "customer_id",
      "type": "string",
      "required": true,
      "pattern": "^CUST[0-9]{8}$",
      "description": "Customer identifier"
    },
    {
      "field": "timestamp",
      "type": "datetime",
      "required": true,
      "format": "ISO8601",
      "description": "Transaction timestamp"
    },
    {
      "field": "risk_indicators",
      "type": "object",
      "required": false,
      "properties": {
        "velocity_check": {"type": "boolean"},
        "geolocation_match": {"type": "boolean"},
        "device_fingerprint": {"type": "string"}
      },
      "description": "Fraud prevention indicators"
    }
  ],
  "risk_rules": [
    {
      "name": "high_value_transaction",
      "condition": "amount > 10000",
      "risk_level": "HIGH",
      "action": "require_manual_approval"
    },
    {
      "name": "foreign_transaction",
      "condition": "merchant_info.country != customer_country",
      "risk_level": "MEDIUM",
      "action": "additional_verification"
    },
    {
      "name": "velocity_limit",
      "condition": "daily_transaction_count > 10 OR daily_amount > 50000",
      "risk_level": "HIGH",
      "action": "block_transaction"
    }
  ],
  "compliance": {
    "pci_dss": true,
    "aml_required": true,
    "fraud_monitoring": true
  }
}