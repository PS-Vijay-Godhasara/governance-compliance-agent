{
  "policy_id": "api_security_validation",
  "name": "API Security Validation Policy",
  "version": "2.1",
  "description": "Security validation rules for API requests and integrations",
  "rules": [
    {
      "field": "authentication",
      "type": "object",
      "required": true,
      "properties": {
        "method": {"type": "string", "required": true, "enum": ["api_key", "oauth2", "jwt", "basic_auth"]},
        "token": {"type": "string", "required": true, "min_length": 32},
        "expiry": {"type": "datetime", "min_date": "now+5minutes"},
        "scope": {"type": "array", "items": {"enum": ["read", "write", "admin", "delete"]}}
      },
      "description": "API authentication requirements"
    },
    {
      "field": "request_metadata",
      "type": "object",
      "required": true,
      "properties": {
        "client_id": {"type": "string", "required": true, "pattern": "^CLIENT_[A-Z0-9]{8}$"},
        "user_agent": {"type": "string", "required": true, "min_length": 10},
        "ip_address": {"type": "string", "required": true, "pattern": "^(?:[0-9]{1,3}\\.){3}[0-9]{1,3}$"},
        "timestamp": {"type": "datetime", "required": true, "max_age_minutes": 5}
      },
      "description": "Request metadata and tracking"
    },
    {
      "field": "rate_limiting",
      "type": "object",
      "required": true,
      "properties": {
        "requests_per_minute": {"type": "integer", "max": 1000},
        "requests_per_hour": {"type": "integer", "max": 10000},
        "burst_limit": {"type": "integer", "max": 100},
        "concurrent_requests": {"type": "integer", "max": 50}
      },
      "description": "Rate limiting constraints"
    },
    {
      "field": "data_validation",
      "type": "object",
      "required": true,
      "properties": {
        "input_sanitization": {"type": "boolean", "required": true, "value": true},
        "sql_injection_check": {"type": "boolean", "required": true, "value": true},
        "xss_protection": {"type": "boolean", "required": true, "value": true},
        "data_size_limit_mb": {"type": "integer", "max": 100}
      },
      "description": "Input validation and security checks"
    },
    {
      "field": "encryption_requirements",
      "type": "object",
      "required": true,
      "properties": {
        "tls_version": {"type": "string", "required": true, "enum": ["1.2", "1.3"]},
        "cipher_suite": {"type": "string", "required": true},
        "certificate_valid": {"type": "boolean", "required": true, "value": true},
        "hsts_enabled": {"type": "boolean", "required": true, "value": true}
      },
      "description": "Encryption and transport security"
    },
    {
      "field": "audit_logging",
      "type": "object",
      "required": true,
      "properties": {
        "request_logged": {"type": "boolean", "required": true, "value": true},
        "response_logged": {"type": "boolean", "required": true, "value": true},
        "error_logged": {"type": "boolean", "required": true, "value": true},
        "retention_days": {"type": "integer", "min": 90, "max": 2555}
      },
      "description": "Audit logging requirements"
    },
    {
      "field": "access_control",
      "type": "object",
      "required": true,
      "properties": {
        "resource_permissions": {"type": "array", "required": true, "min_items": 1},
        "ip_whitelist": {"type": "array", "items": {"type": "string"}},
        "geo_restrictions": {"type": "array", "items": {"type": "string"}},
        "time_based_access": {"type": "object", "properties": {"start_hour": {"type": "integer"}, "end_hour": {"type": "integer"}}}
      },
      "description": "Access control and restrictions"
    }
  ],
  "security_rules": [
    {
      "name": "suspicious_activity_detection",
      "condition": "requests_per_minute > 500 OR failed_auth_attempts > 5",
      "action": "temporary_block",
      "duration_minutes": 15
    },
    {
      "name": "high_privilege_operations",
      "condition": "scope CONTAINS 'admin' OR scope CONTAINS 'delete'",
      "action": "require_mfa",
      "additional_verification": true
    },
    {
      "name": "data_export_restrictions",
      "condition": "operation == 'bulk_export' AND data_size > 10MB",
      "action": "require_approval",
      "approval_level": "manager"
    },
    {
      "name": "cross_origin_requests",
      "condition": "origin_domain NOT IN allowed_domains",
      "action": "block_request",
      "log_security_event": true
    }
  ],
  "compliance_standards": [
    "OWASP_API_Security_Top_10",
    "ISO_27001",
    "SOC_2_Type_II",
    "PCI_DSS"
  ],
  "monitoring_alerts": [
    {
      "name": "authentication_failures",
      "threshold": "failed_attempts > 10 in 5 minutes",
      "severity": "high"
    },
    {
      "name": "unusual_traffic_patterns",
      "threshold": "requests_per_minute > 2x_baseline",
      "severity": "medium"
    },
    {
      "name": "data_breach_indicators",
      "threshold": "bulk_data_access AND new_client_id",
      "severity": "critical"
    }
  ]
}